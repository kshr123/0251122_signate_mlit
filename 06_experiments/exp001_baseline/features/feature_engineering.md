# ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°è©³ç´°

> exp001_baseline - ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«

---

## ğŸ“Š ç‰¹å¾´é‡ã‚µãƒãƒªãƒ¼

- **å…¨ç‰¹å¾´é‡æ•°**: 106
- **æ•°å€¤ç‰¹å¾´é‡**: 96
- **ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«ç‰¹å¾´é‡**: 8
- **ç”Ÿæˆç‰¹å¾´é‡**: 2

---

## 1. æ•°å€¤ç‰¹å¾´é‡ï¼ˆ96å€‹ï¼‰

### æ–¹é‡
- **ç”Ÿãƒ‡ãƒ¼ã‚¿ã‚’ãã®ã¾ã¾ä½¿ç”¨**
- å¤‰æ›ãªã—ã€ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ãªã—
- æ¬ æå€¤ã¯æœªè£œå®Œï¼ˆLightGBMã®è‡ªå‹•å‡¦ç†ã«ä»»ã›ã‚‹ï¼‰

### ç‰¹å¾´é‡ã‚°ãƒ«ãƒ¼ãƒ—

#### ç‰©ä»¶æƒ…å ±
- `floor_max`, `floor_min` - éšæ•°
- `age` - ç¯‰å¹´æ•°
- `area_room`, `area_balcony` - é¢ç©

#### ç«‹åœ°æƒ…å ±
- `pref_code`, `city_code` - éƒ½é“åºœçœŒãƒ»å¸‚åŒºç”ºæ‘ã‚³ãƒ¼ãƒ‰
- `station_*` - é§…ã¾ã§ã®è·é›¢ãƒ»æ™‚é–“
- `traffic_*` - äº¤é€šæƒ…å ±

#### è¨­å‚™æƒ…å ±
- `equip_*` - å„ç¨®è¨­å‚™ã®æœ‰ç„¡

#### ãã®ä»–
- å¤šæ•°ã®æ•°å€¤ç‰¹å¾´é‡ï¼ˆè©³ç´°ã¯ `feature_list.txt` ã‚’å‚ç…§ï¼‰

---

## 2. ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«ç‰¹å¾´é‡ï¼ˆ8å€‹ï¼‰

### æ–¹é‡
- **ä½ã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£ï¼ˆ<50ï¼‰ã®ã¿ä½¿ç”¨**
- ãƒ©ãƒ™ãƒ«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆPolars Categorical â†’ ordinalï¼‰

### ä½¿ç”¨ã—ãŸç‰¹å¾´é‡

| ç‰¹å¾´é‡å | èª¬æ˜ | ã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£ |
|---------|------|-----------------|
| `building_name_ruby` | å»ºç‰©åï¼ˆèª­ã¿ï¼‰ | ä½ |
| `reform_exterior` | å¤–è£…ãƒªãƒ•ã‚©ãƒ¼ãƒ  | ä½ |
| `name_ruby` | åç§°ï¼ˆèª­ã¿ï¼‰ | ä½ |
| `school_ele_code` | å°å­¦æ ¡ã‚³ãƒ¼ãƒ‰ | ä½ |
| `school_jun_code` | ä¸­å­¦æ ¡ã‚³ãƒ¼ãƒ‰ | ä½ |
| `money_hoshou_company` | ä¿è¨¼ä¼šç¤¾ | ä½ |
| `free_rent_duration` | ãƒ•ãƒªãƒ¼ãƒ¬ãƒ³ãƒˆæœŸé–“ | ä½ |
| `free_rent_gen_timing` | ãƒ•ãƒªãƒ¼ãƒ¬ãƒ³ãƒˆé–‹å§‹ã‚¿ã‚¤ãƒŸãƒ³ã‚° | ä½ |

**æ³¨æ„**:
- ã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£50ä»¥ä¸Šã®ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«å¤‰æ•°ã¯é™¤å¤–
- ä»Šå¾Œã®å®Ÿé¨“ã§é«˜ã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ‰‹æ³•ã‚’æ¤œè¨

---

## 3. ç”Ÿæˆç‰¹å¾´é‡ï¼ˆ2å€‹ï¼‰

| ç‰¹å¾´é‡å | ç”Ÿæˆå¼ | èª¬æ˜ |
|---------|-------|------|
| `target_year` | `target_ym // 100` | å¯¾è±¡å¹´ |
| `target_month` | `target_ym % 100` | å¯¾è±¡æœˆ |

**å…ƒã®ç‰¹å¾´é‡**: `target_ym`ï¼ˆYYYYMMå½¢å¼ï¼‰

**ç›®çš„**:
- å¹´ãƒ»æœˆã‚’åˆ†é›¢ã—ã¦æ™‚ç³»åˆ—ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å­¦ç¿’
- å­£ç¯€æ€§ã®æ•æ‰

---

## 4. é™¤å¤–ã—ãŸç‰¹å¾´é‡

### ã‚·ã‚¹ãƒ†ãƒ ã‚«ãƒ©ãƒ 
- `id` - ã‚µãƒ³ãƒ—ãƒ«è­˜åˆ¥å­ï¼ˆäºˆæ¸¬ã«ä¸è¦ï¼‰
- `money_room` - ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå¤‰æ•°
- `target_ym` - åˆ†è§£å¾Œã¯ä¸è¦

### é«˜ã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«
- ã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£ >= 50 ã®ç‰¹å¾´é‡ã¯è‡ªå‹•é™¤å¤–
- ä»Šå¾Œã®å®Ÿé¨“ã§ä»¥ä¸‹ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ‰‹æ³•ã‚’æ¤œè¨ï¼š
  - Target Encoding
  - Frequency Encoding
  - Hash Encoding
  - Embedding

### æœªä½¿ç”¨ã®æƒ…å ±
- **ä½æ‰€ãƒ†ã‚­ã‚¹ãƒˆæƒ…å ±**ï¼ˆéƒ½é“åºœçœŒåãƒ»å¸‚åŒºç”ºæ‘åï¼‰
  - ä»Šå¾Œè¿½åŠ äºˆå®š
  - éƒ½é“åºœçœŒãƒ€ãƒŸãƒ¼å¤‰æ•°ã€å¸‚åŒºç”ºæ‘ãƒ€ãƒŸãƒ¼å¤‰æ•°ãªã©

---

## 5. ãƒ‡ãƒ¼ã‚¿å‹ã®å‡¦ç†

### å•é¡Œ: train/testã§ãƒ‡ãƒ¼ã‚¿å‹ãŒç•°ãªã‚‹ã‚«ãƒ©ãƒ 

**ç™ºè¦‹ã•ã‚ŒãŸå•é¡Œ**:
- `traffic_car` ã‚«ãƒ©ãƒ 
  - Train: `Int64` å‹
  - Test: `String` å‹

**è§£æ±ºç­–**:
- trainã¨testã®ä¸¡æ–¹ã§æ–‡å­—åˆ—å‹ã‚«ãƒ©ãƒ ã‚’æ¤œå‡º
- ã™ã¹ã¦ `pl.Categorical â†’ ordinal` ã«å¤‰æ›

```python
# trainã¨testã§å‹ãŒç•°ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€ä¸¡æ–¹ã§æ–‡å­—åˆ—å‹ã‚’æ¤œå‡º
string_cols_train = [col for col in X_train.columns if X_train[col].dtype == pl.Utf8]
string_cols_test = [col for col in X_test.columns if X_test[col].dtype == pl.Utf8]
string_cols = list(set(string_cols_train + string_cols_test))

# ã™ã¹ã¦ã®æ–‡å­—åˆ—å‹ã‚«ãƒ©ãƒ ã‚’æ•°å€¤ã«å¤‰æ›
for col in string_cols:
    if col in X_train.columns and X_train[col].dtype == pl.Utf8:
        X_train = X_train.with_columns(
            pl.col(col).cast(pl.Categorical).to_physical().alias(col)
        )
    if col in X_test.columns and X_test[col].dtype == pl.Utf8:
        X_test = X_test.with_columns(
            pl.col(col).cast(pl.Categorical).to_physical().alias(col)
        )
```

---

## 6. ä»Šå¾Œã®æ”¹å–„æ–¹å‘

### å„ªå…ˆåº¦: é«˜
1. **ä½æ‰€æƒ…å ±ã®è¿½åŠ **
   - éƒ½é“åºœçœŒåãƒ»å¸‚åŒºç”ºæ‘åã®ãƒ€ãƒŸãƒ¼å¤‰æ•°åŒ–
   - åœ°åŸŸç‰¹æ€§ã®æ•æ‰

2. **é«˜ã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£ã®å‡¦ç†**
   - Target Encoding
   - Frequency Encoding

### å„ªå…ˆåº¦: ä¸­
3. **ç‰¹å¾´é‡äº¤äº’ä½œç”¨**
   - `area_room * floor_max` ãªã©
   - ãƒ‰ãƒ¡ã‚¤ãƒ³çŸ¥è­˜ã«åŸºã¥ãçµ„ã¿åˆã‚ã›

4. **æ™‚ç³»åˆ—ç‰¹å¾´é‡**
   - ãƒ©ã‚°ç‰¹å¾´é‡
   - ç§»å‹•å¹³å‡

### å„ªå…ˆåº¦: ä½
5. **å¤–éƒ¨ãƒ‡ãƒ¼ã‚¿**
   - åœ°ä¾¡ãƒ‡ãƒ¼ã‚¿
   - äººå£çµ±è¨ˆ

---

## 7. ç‰¹å¾´é‡é‡è¦åº¦

**æ³¨æ„**: ç‰¹å¾´é‡é‡è¦åº¦ã¯ `feature_importance.csv` ã‚’å‚ç…§

ä»Šå¾Œã®å®Ÿé¨“ã§ä»¥ä¸‹ã‚’åˆ†æï¼š
- Gainé‡è¦åº¦
- Splité‡è¦åº¦
- Permutation Importance
- SHAPå€¤

---

**ä½œæˆæ—¥**: 2025-11-24
**å®Ÿé¨“**: exp001_baseline
