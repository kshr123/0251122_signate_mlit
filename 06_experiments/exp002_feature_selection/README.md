# exp002: 特徴量選択実験

## 概要

削除フラグカラムと欠損率95%以上のカラムを除外した実験。

## 結果サマリ

| 指標 | 値 |
|------|-----|
| CV MAPE | **28.26%** |
| 標準偏差 | 0.06% |
| OOF MAPE | 28.26% |
| 特徴量数 | 84個 |

### exp001との比較

| 項目 | exp001 (baseline) | exp002 (feature_selection) | 差分 |
|------|-------------------|---------------------------|------|
| CV MAPE | 28.34% | **28.26%** | -0.08pt |
| 特徴量数 | 106個 | 84個 | -22個 |

## 除外カラム（46個）

### 削除フラグカラム（13個）
コンペ運営が指定した使用禁止カラム

| No. | カラム名 | 意味 |
|-----|---------|------|
| 3 | building_id | 棟ID（AUTO_INCREMENT） |
| 5 | building_create_date | 作成日時 |
| 6 | building_modify_date | 修正日時 |
| 8 | building_name | 建物名 |
| 9 | building_name_ruby | 建物名フリガナ |
| 10 | homes_building_name | HOME'S建物名 |
| 11 | homes_building_name_ruby | HOME'S建物名フリガナ |
| 13 | full_address | 住所（全住所文字列） |
| 69 | snapshot_create_date | 作成日時 |
| 70 | new_date | 公開日時 |
| 71 | snapshot_modify_date | 修正日時 |
| 130 | school_ele_name | 小学校名 |
| 133 | school_jun_name | 中学校名 |

### 欠損率95%以上のカラム（31個）

| カラム名 | 欠損率 |
|---------|--------|
| building_name_ruby | 100.00% |
| name_ruby | 100.00% |
| school_ele_code | 100.00% |
| school_jun_code | 100.00% |
| money_hoshou_company | 100.00% |
| free_rent_duration | 100.00% |
| free_rent_gen_timing | 100.00% |
| traffic_car | 100.00% |
| reform_etc | 99.88% |
| reform_place_other | 99.76% |
| reform_place | 99.72% |
| reform_date | 99.65% |
| reform_common_area | 99.37% |
| reform_common_area_date | 99.37% |
| その他17個... | 95-99% |

## EDA結果

### 特徴量重要度 Top 10

| 順位 | 特徴量 | 意味 |
|------|--------|------|
| 1 | house_area | 専有面積 |
| 2 | post1 | 郵便番号上3桁 |
| 3 | year_built | 築年 |
| 4 | money_kyoueki | 共益費 |
| 5 | addr1_2 | 市区町村コード |
| 6 | lat | 緯度 |
| 7 | madori_kind_all | 間取り種類 |
| 8 | el | 経度上位 |
| 9 | lon | 経度 |
| 10 | nl | 緯度上位 |

### 都道府県別誤差

**高APE（予測困難）:**
1. 和歌山県: 51.14%
2. 奈良県: 45.38%
3. 岐阜県: 42.98%
4. 滋賀県: 40.41%
5. 佐賀県: 40.07%

**低APE（予測良好）:**
1. 大分県: 18.57%
2. 東京都: 19.93%
3. 沖縄県: 21.23%
4. 宮崎県: 22.63%
5. 山形県: 23.17%

### 価格帯別誤差

| 価格帯 | 平均APE | 中央値APE | 件数 |
|--------|---------|-----------|------|
| ~1000万 | 75.19% | 64.32% | 48,356 |
| 1000~1500万 | 30.30% | 21.48% | 57,370 |
| 1500~2000万 | 22.56% | 17.88% | 62,787 |
| 2000~3000万 | 17.33% | 14.07% | 94,034 |
| 3000~5000万 | 17.09% | 14.43% | 75,203 |
| 5000万~ | 22.14% | 19.39% | 26,174 |

**考察:** 低価格帯（~1000万）の予測が特に困難。1000万円未満の物件は特殊な条件がある可能性。

### 築年数別誤差

| 築年数 | 平均APE | 中央値APE | 件数 |
|--------|---------|-----------|------|
| ~5年 | 42.41% | 24.07% | 5,722 |
| 5~10年 | 17.52% | 13.47% | 21,637 |
| 10~20年 | 19.27% | 14.38% | 57,193 |
| 20~30年 | 24.12% | 17.13% | 84,310 |
| 30~40年 | 30.74% | 21.42% | 78,374 |
| 40年~ | 35.29% | 22.78% | 116,688 |

**考察:** 築5~10年が最も予測しやすい。新築（~5年）と古い物件（30年~）は予測が難しい。

## 出力ファイル

```
outputs/
├── submission_20251125_114002.csv    # 提出ファイル
├── oof_predictions_20251125_114002.csv   # OOF予測
├── feature_importance_20251125_114002.csv   # 特徴量重要度
└── feature_importance_20251125_114002.json

notebooks/figures/
├── error_distribution.png    # 誤差分布
├── feature_importance.png    # 特徴量重要度
└── prefecture_ape.png        # 都道府県別APE
```

## 次のアクション候補

1. **地域特徴量の追加**: 都道府県ダミー、地域別平均価格など
2. **価格帯別モデル**: 低価格帯は別モデルで予測
3. **築年数の非線形変換**: 築年数の2乗項、log変換など
4. **外れ値対応**: 低価格帯の外れ値（500万以下）を除外して学習
5. **面積あたり単価**: money_room / house_area を特徴量に追加
